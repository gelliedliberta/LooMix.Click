# LooMix.Click - Basitleştirilmiş Apache Configuration
# Modern haber sitesi için optimize edilmiş .htaccess

# =====================================
# URL Rewriting (Router için gerekli)
# =====================================
RewriteEngine On

# Dosya ve klasör yoksa index.php'ye yönlendir
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule ^(.*)$ index.php [QSA,L]

# =====================================
# Güvenlik Ayarları (Temel)
# =====================================

# Dizin listesini engelle
Options -Indexes

# Hassas dosyaları gizle
<FilesMatch "^(\.env|composer\.(json|lock)|\.git)">
    Order allow,deny
    Deny from all
</FilesMatch>

# Config ve database dosyalarını koru
<FilesMatch "^(config|database)/.*\.php$">
    Order allow,deny
    Deny from all
</FilesMatch>

# Markdown ve SQL gibi düz metin dosyalarını koru
<FilesMatch "\.(md|sql|yml|yaml|lock)$">
    Order allow,deny
    Deny from all
</FilesMatch>

# Upload klasöründe PHP çalıştırmayı engelle
# Alternatif: yol bazlı engelleme
RewriteRule ^assets/uploads/.*\.(php|php[0-9])$ - [F,L]

# =====================================
# Development Settings
# =====================================

# PHP hata raporlama (development için aktif) - Prod'da kapalı
# Prod'da index.php içinde DEBUG_MODE = false olduğunda kapatılıyor

# =====================================
# Performance & Caching (Basit)
# =====================================

# Dosya sıkıştırma (Gzip) - sadece temel dosyalar
<IfModule mod_deflate.c>
    AddOutputFilterByType DEFLATE text/plain
    AddOutputFilterByType DEFLATE text/html
    AddOutputFilterByType DEFLATE text/css
    AddOutputFilterByType DEFLATE application/javascript
    AddOutputFilterByType DEFLATE application/json
</IfModule>

# Basit tarayıcı önbellek ayarları
<IfModule mod_expires.c>
    ExpiresActive On
    
    # Resimler - 1 hafta
    ExpiresByType image/jpg "access plus 1 week"
    ExpiresByType image/jpeg "access plus 1 week"
    ExpiresByType image/png "access plus 1 week"
    ExpiresByType image/gif "access plus 1 week"
    ExpiresByType image/webp "access plus 1 week"
    
    # CSS ve JavaScript - 1 gün
    ExpiresByType text/css "access plus 1 day"
    ExpiresByType application/javascript "access plus 1 day"
</IfModule>

# =====================================
# Error Pages
# =====================================

# Özel hata sayfaları
ErrorDocument 404 /index.php
ErrorDocument 403 /index.php
ErrorDocument 500 /index.php

# =====================================
# MIME Types (Temel)
# =====================================

# WebP desteği
<IfModule mod_mime.c>
    AddType image/webp .webp
</IfModule>

# =====================================
# SEO (Temel)
# =====================================

# Trailing slash'leri kaldır (SEO için)
RewriteCond %{REQUEST_FILENAME} !-d
RewriteCond %{REQUEST_URI} ^(.+)/$
RewriteRule ^(.+)/$ /$1 [R=301,L]

# =====================================
# Güvenlik Headers (Temel)
# =====================================

<IfModule mod_headers.c>
    # Temel güvenlik headers
    Header always set X-Content-Type-Options nosniff
    Header always set X-Frame-Options SAMEORIGIN
    Header always set X-XSS-Protection "1; mode=block"
</IfModule>